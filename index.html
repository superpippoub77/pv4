<!DOCTYPE html>
<html lang="it">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <!-- Titolo SEO ottimizzato -->
    <title>Volleyball Coach Pro W4 - Editor e Workout per Allenatori di Pallavolo</title>
    <meta name="author" content="Filippo Morano">
    <!-- Meta descrizione SEO -->
    <meta name="description"
        content="Volleyball Coach Pro W4: il software professionale per allenatori di pallavolo. Crea schemi, programmi di workout e migliora le prestazioni della tua squadra.">

    <!-- Meta keyword (opzionale, poco usata oggi ma a volte utile) -->
    <meta name="keywords"
        content="Volleyball Coach, Volleyball Workout, Allenatori Pallavolo, Schemi Pallavolo, Software Allenamento">

    <!-- Open Graph per condivisione social -->
    <meta property="og:title" content="Volleyball Coach Pro W4 - Editor e Workout per Allenatori di Pallavolo">
    <meta property="og:description"
        content="Crea schemi, gestisci workout e migliora le prestazioni della tua squadra con Volleyball Coach Pro W4.">
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://www.filippomorano.com/">
    <meta property="og:image" content="https://www.filippomorano.com/immagine_preview.png">

    <!-- Favicon -->
    <link rel="apple-touch-icon" sizes="180x180" href="data/images/favicon/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="data/images/favicon/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="data/images/favicon/favicon-16x16.png">
    <link rel="manifest" href="data/images/favicon/site.webmanifest">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <!-- <script src="https://cdn.tailwindcss.com"></script> -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="./css/main.css">
</head>

<body style="display: flex; flex-direction: column;">
    <!-- MAIN CONTENT -->
    <div id="container" class="container">


        <div class="sidebar" id="sidebar">
        </div>
        <div class="main-content">
            <div class="tabs-container">
                <div class="tab active" data-tab-id="1">
                    <input class='no-style tab-title' value='Schema 1' />
                    <span class="tab-close">√ó</span>
                </div>
                <button class="add-tab" data-i18n="local_add_tab_btn">+ Nuovo</button>
            </div>

            <div class="canvas-container">
                <div class="canvas" id="canvas"></div>
                <svg style="position: absolute; width: 0; height: 0;">
                    <defs>
                        <marker id="arrowhead" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
                            <polygon points="0 0, 10 3.5, 0 7" />
                        </marker>
                    </defs>
                </svg>
            </div>
        </div>

        <div class="right-sidebar" id="rightSidebar">
        </div>

    </div>

    <!-- FOOTER HANDLE BUTTON -->
    <!-- <div class="bottom-sidebar-handle" id="bottomSidebarHandle">
        <button class="bottom-sidebar-switch" id="bottomSidebarSwitch">‚ñº</button>
    </div> -->
    <!-- FOOTER -->
    <!-- <div id="footer" class="footer">
        <div class="bottom-toolbar-group">
            <fieldset id="objectControls" class="toolbar-group fixed form-grid" style="display: none">
                <legend data-i18n="local_object_legend">Oggetto</legend>

                <label data-i18n="local_object_color_label">Colore oggetto:</label>
                <input type="color" class="color-picker" id="objectColor" value="#3498db">

                <label data-i18n="local_object_opacity_label">Opacit√†:</label>
                <input type="range" id="objectOpacity" min="0" max="1" value="1" step="0.01">

                <label data-i18n="local_object_opacity_value_label">Valore opacit√†:</label>
                <input type="number" id="objectOpacityValue" class="small-input" min="0" max="1" step="0.01"
                    value="1.00">

                <label data-i18n="local_object_text_label">Testo:</label>
                <input type="text" id="objectText" placeholder="Modifica testo">

                <label data-i18n="local_object_number_label">Numero etichetta:</label>
                <input type="number" id="objectNumber" min="1" placeholder="Numero" class="small-input">

                <button id="dashedObjectToggle" class="toolbar-button"
                    data-i18n="local_dashed_object_toggle">Tratteggiato</button>
                <button id="deleteBtn" data-i18n="local_delete_button">üóëÔ∏è Elimina</button>

            </fieldset>

            <fieldset id="arrowControls" class="toolbar-group fixed" style="display: none">
                <legend data-i18n="local_arrow_legend">Freccia</legend>
                <div class="color-picker-container">
                    <label data-i18n="local_arrow_color_label">Colore freccia:</label>
                    <input type="color" class="color-picker" id="arrowColor" value="#000000">
                </div>
                <div>
                    <label data-i18n="local_arrow_opacity_label">Opacit√†:</label>
                    <input type="range" id="arrowOpacity" min="0" max="1" value="1" step="0.01">
                    <span id="arrowOpacityValue">1.00</span>
                </div>
                <div>
                    <label data-i18n="local_arrow_thickness_label">Spessore:</label>
                    <input type="range" id="arrowThickness" min="1" max="10" value="3">
                    <span id="thicknessValue">3</span>
                </div>
                <div class="arrow-type-controls">
                    <label data-i18n="local_arrow_type_label">Tipo:</label>
                    <button id="arrowTypeLinear" class="arrow-type-btn"
                        data-i18n="local_arrow_type_linear">Lineare</button>
                    <button id="arrowTypeCurved" class="arrow-type-btn"
                        data-i18n="local_arrow_type_curved">Curva</button>
                    <button id="arrowTypeZigzag" class="arrow-type-btn"
                        data-i18n="local_arrow_type_zigzag">Zigzag</button>
                </div>
                <button id="dashedArrowToggle" class="toolbar-button" data-i18n="local_dashed_arrow_toggle">Freccia
                    Tratteggiata</button>
                <div class="arrow-marker-controls">
                    <input type="checkbox" id="arrowMarkerStart"><label
                        data-i18n="local_arrow_marker_start_label">Inizio</label>
                    <input type="checkbox" id="arrowMarkerEnd" checked><label
                        data-i18n="local_arrow_marker_end_label">Fine</label>
                </div>
            </fieldset>

            <fieldset id="spriteControls" class="toolbar-group fixed" style="display: none">
                <legend data-i18n="local_sprite_legend">Sprite</legend>
                <div>
                    <label data-i18n="local_sprite_current_frame_label">Frame corrente:</label>
                    <input type="number" id="spriteCurrentFrame" min="0" max="7" value="0" style="width: 60px;">
                    <span id="spriteFrameInfo">(0-7)</span>
                </div>

                <div class="sprite-animation-controls">
                    <label data-i18n="local_sprite_animation_label">Animazione:</label>
                    <input type="text" id="spriteAnimationFrames" placeholder="es: 0,1,2,3" style="width: 120px;"
                        title="Sequenza frame separati da virgola">
                    <label data-i18n="local_sprite_animation_fps_label">FPS:</label>
                    <input type="number" id="spriteAnimationFPS" min="1" max="60" value="10" style="width: 60px;">
                    <button id="spritePlayAnimation" class="toolbar-button">‚ñ∂ Play</button>
                    <button id="spriteStopAnimation" class="toolbar-button" style="display: none;">‚è∏
                        Stop</button>
                </div>

                <div>
                    <label data-i18n="local_sprite_frame_size_label">Dimensioni frame:</label>
                    <input type="number" id="spriteFrameWidth" min="8" max="512" value="64" style="width: 60px;">
                    <span>√ó</span>
                    <input type="number" id="spriteFrameHeight" min="8" max="512" value="64" style="width: 60px;">
                    <button id="spriteApplySize" class="toolbar-button">Applica</button>
                </div>
            </fieldset>

            <fieldset id="freehandControls" class="toolbar-group fixed" style="display: none">
                <legend data-i18n="local_freehand_legend">Disegno a mano libera</legend>
                <div class="color-picker-container">
                    <label data-i18n="local_freehand_color_label">Colore traccia:</label>
                    <input type="color" class="color-picker" id="freehandColor" value="#000000">
                </div>
                <div>
                    <label data-i18n="local_freehand_thickness_label">Spessore:</label>
                    <input type="range" id="freehandThickness" min="1" max="15" value="3">
                    <span id="freehandThicknessValue">3</span>
                </div>
                <div>
                    <label data-i18n="local_freehand_opacity_label">Opacit√†:</label>
                    <input type="range" id="freehandOpacity" min="0" max="1" value="1" step="0.01">
                    <span id="freehandOpacityValue">1.00</span>
                </div>
            </fieldset>
            <fieldset id="objectInfo" class="toolbar-group" data-i18n="local_no_object_selected">Nessun oggetto
                selezionato</fieldset>
        </div>
    </div> -->

    <!-- Login Modal - VolleyProW4 Edition -->
    <!-- <div id="login" class="login-modal">
    </div> -->

    <div id="animationDialog">
        <div class="animation-dialog-header" id="animationDialogHeader">
            <h3 data-i18n="local_animation_controls_title">üé¨ Controlli Animazione</h3>
            <button class="animation-dialog-close" id="closeAnimationDialog">&times;</button>
        </div>
        <div class="animation-dialog-body">
            <!-- Controlli Riproduzione -->
            <div class="animation-control-section">
                <h4 data-i18n="local_animation_playback_title">‚ñ∂Ô∏è Riproduzione</h4>
                <div class="animation-controls-row">
                    <button id="animationPlay" title="Play">‚ñ∂Ô∏è</button>
                    <button id="animationPause" title="Pause" style="display: none;">‚è∏Ô∏è</button>
                    <button id="animationStop" title="Stop">‚èπÔ∏è</button>
                    <button id="animationPrevFrame" title="Frame Precedente">‚èÆÔ∏è</button>
                    <button id="animationNextFrame" title="Frame Successivo">‚è≠Ô∏è</button>
                    <span class="frame-display" id="currentFrameDisplay">Frame: 0</span>
                </div>
            </div>

            <!-- Velocit√† -->
            <div class="animation-control-section">
                <h4 data-i18n="local_animation_speed_title">‚ö° Velocit√†</h4>
                <div class="animation-controls-row">
                    <label>ms/frame:</label>
                    <input type="number" id="animationSpeed" min="100" max="5000" value="1000" step="100">
                </div>
            </div>

            <!-- Gestione Frame -->
            <div class="animation-control-section">
                <h4 data-i18n="local_animation_frame_timeline_title">üìã Frame Timeline</h4>
                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 8px;">
                    <button id="addFrameBtn" style="background: #27ae60; color: white; border: none;">‚ûï Nuovo
                        Frame</button>
                </div>
                <div id="framesList">
                    <!-- Popolato dinamicamente -->
                </div>
            </div>

            <!-- Propriet√† Frame Selezionato -->
            <div id="frameProperties" style="display: none;">
                <h5 data-i18n="local_animation_frame_properties_title">üé® Propriet√† Frame <span id="frameNumber"></span>
                </h5>
                <div style="margin-bottom: 10px;">
                    <label style="font-weight: bold;">‚è±Ô∏è Timestamp (ms): <input type="number" id="frameTimestamp"
                            min="0" step="100" style="width: 100px;"></label>
                    <span style="font-size: 10px; color: #7f8c8d; margin-left: 10px;">(tempo in millisecondi nella
                        timeline)</span>
                </div>
                <div class="frame-properties-grid">
                    <label>X: <input type="number" id="frameX" step="1"></label>
                    <label>Y: <input type="number" id="frameY" step="1"></label>
                    <label>Larghezza: <input type="number" id="frameWidth" step="1"></label>
                    <label>Altezza: <input type="number" id="frameHeight" step="1"></label>
                    <label>Rotazione: <input type="number" id="frameRotation" step="15"></label>
                    <label>Opacit√†: <input type="number" id="frameOpacity" min="0" max="1" step="0.1"></label>
                    <label>Colore: <input type="color" id="frameColor"></label>
                    <label style="flex-direction: row; align-items: center;">
                        <input type="checkbox" id="frameDashed" data-i18n="local_frame_dashed_checkbox"> Tratteggiato
                    </label>
                </div>
                <div class="frame-actions">
                    <button id="updateFrameBtn" data-i18n="local_update_frame_button">üíæ Aggiorna</button>
                    <button id="deleteFrameBtn" data-i18n="local_delete_frame_button">üóëÔ∏è Elimina</button>
                </div>
            </div>
        </div>
    </div>

    <water-mark></water-mark>

    <!-- CONSTANTS AND OBJECTS -->
    <script defer src="constants/configuration.js"></script>
    <script defer src="constants/dic.js"></script>
    <script defer src="constants/preset-actions.js"></script>
    <script defer src="constants/template.js"></script>
    <script defer src="constants/menu.js"></script>
    <script defer src="constants/toolbar.js"></script>
    <script defer src="constants/sidebar.js"></script>

    <!-- CLASS -->
    <script defer src="components/storage/storage.class.js"></script>
    <script defer src="components/menu/menu.class.js"></script>
    <script defer src="components/toolbar/toolbar.class.js"></script>
    <script defer src="components/sidebar/sidebar.class.js"></script>
    <script defer src="components/login/login.class.js"></script>
    <script defer src="components/history/history.class.js"></script>
    <script defer src="components/teammanagement/teammanagement.class.js"></script>
    <script defer src="components/workout/libraryworkout.class.js"></script>
    <script defer src="components/workout/saveworkout.class.js"></script>

    <!-- COMPONENTS -->
    <script defer src="components/macro_recorder_system.js"></script>

    <!-- EXTENSION -->
    <script defer src="components/schemaeditor.js"></script>
    <script defer src="components/helper.js"></script>
    <script defer src="components/components.js"></script>

    <script>
        const defaultLang = 'it';

        async function initializeEditor() {
            // Controlla se l'editor √® gi√† inizializzato
            if (window.editor) {
                console.log("Editor gi√† inizializzato");
                return; // Non ricreare nulla
            }

            // Inizializza loginManager
            loginManager = new LoginManager({
                userDataUrl: 'data/users.json',
                onLoginSuccess: async (username) => {
                    // Controlla di nuovo se l'editor esiste
                    if (!window.editor) {
                        setDefaultDate('workoutDate');
                        storage = new Storage(username);
                        window.editor = new SchemaEditor(configuration, menuData, username, storage);
                        await window.editor.initialize();

                        const langSelector = document.getElementById('languageSelector');
                        langSelector.value = defaultLang;
                        setLanguage(defaultLang);

                        langSelector.addEventListener('change', (event) => {
                            setLanguage(event.target.value);
                            translateElements(event.target.value);
                        });
                    }
                },
                onLogoutSuccess: () => {
                    if (window.editor) {
                        window.editor.handleLogoutSuccess();
                        window.editor = null; // Permette di reinizializzare dopo il logout
                    }
                }
            });

            // Listener per esportazione PDF
            const exportBtn = document.getElementById('exportPdfBtn');
            if (exportBtn && !exportBtn.dataset.listenerAdded) {
                exportBtn.addEventListener('click', () => {
                    if (window.editor && window.editor.exportWorkoutToPDF) {
                        window.editor.exportWorkoutToPDF();
                    } else {
                        alert('Errore: La funzione di esportazione non √® stata caricata correttamente.');
                    }
                });
                exportBtn.dataset.listenerAdded = "true"; // evita di aggiungere listener duplicati
            }
        }

        document.addEventListener("DOMContentLoaded", () => {
            initializeEditor();
        });
    </script>

</body>

</html>