<!DOCTYPE html>
<html lang="it">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <!-- Titolo SEO ottimizzato -->
    <title>Volleyball Coach Pro W4 - Editor e Workout per Allenatori di Pallavolo</title>
    <meta name="author" content="Filippo Morano">
    <!-- Meta descrizione SEO -->
    <meta name="description"
        content="Volleyball Coach Pro W4: il software professionale per allenatori di pallavolo. Crea schemi, programmi di workout e migliora le prestazioni della tua squadra.">

    <!-- Meta keyword (opzionale, poco usata oggi ma a volte utile) -->
    <meta name="keywords"
        content="Volleyball Coach, Volleyball Workout, Allenatori Pallavolo, Schemi Pallavolo, Software Allenamento">

    <!-- Open Graph per condivisione social -->
    <meta property="og:title" content="Volleyball Coach Pro W4 - Editor e Workout per Allenatori di Pallavolo">
    <meta property="og:description"
        content="Crea schemi, gestisci workout e migliora le prestazioni della tua squadra con Volleyball Coach Pro W4.">
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://www.filippomorano.com/">
    <meta property="og:image" content="https://www.filippomorano.com/immagine_preview.png">

    <!-- Favicon -->
    <link rel="apple-touch-icon" sizes="180x180" href="data/images/favicon/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="data/images/favicon/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="data/images/favicon/favicon-16x16.png">
    <link rel="manifest" href="data/images/favicon/site.webmanifest">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <!-- <script src="https://cdn.tailwindcss.com"></script> -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="./css/main.css">
</head>

<body>
    <!-- MENU BAR - Nuova sezione -->
    <div class="menu-bar" style="display: none;">
    </div>

    <div class="container" style="display: none;">
        <div class="sidebar" id="sidebar">
            <div class="component-category">
                <h3 class="accordion-header active">üë• Giocatori</h3>
                <div class="accordion-content active">
                    <div class="component-grid">
                        <div class="component-item" data-type="player" data-text='P1' data-color="">
                            <div class="component-icon">üèÉ</div>
                            <div>Alzatore 1</div>
                        </div>
                        <div class="component-item" data-type="player" data-text='L1' data-color="">
                            <div class="component-icon">üèÉ</div>
                            <div>Libero 1</div>
                        </div>
                        <div class="component-item" data-type="player" data-text='S1' data-color="">
                            <div class="component-icon">üèÉ</div>
                            <div>Banda 1</div>
                        </div>
                        <div class="component-item" data-type="player" data-text='O1' data-color="">
                            <div class="component-icon">üèÉ</div>
                            <div>Opp 1</div>
                        </div>
                        <div class="component-item" data-type="player" data-text='C1' data-color="">
                            <div class="component-icon">üèÉ</div>
                            <div>Centro 1</div>
                        </div>
                        <div class="component-item" data-type="player" data-text='All' data-color="">
                            <div class="component-icon">üèÉ</div>
                            <div>Allenatore</div>
                        </div>
                        <div class="component-item" data-type="player" data-text='Dir' data-color="">
                            <div class="component-icon">üèÉ</div>
                            <div>Dirigente</div>
                        </div>
                        <div class="component-item green" data-type="player" data-text='P2' data-color="">
                            <div class="component-icon">üèÉ</div>
                            <div>Alzatore 2</div>
                        </div>
                        <div class="component-item green" data-type="player" data-text='L2' data-color="">
                            <div class="component-icon">üèÉ</div>
                            <div>Libero 2</div>
                        </div>
                        <div class="component-item green" data-type="player" data-text='S2' data-color="">
                            <div class="component-icon">üèÉ</div>
                            <div>Banda 2</div>
                        </div>
                        <div class="component-item green" data-type="player" data-text='O2' data-color="">
                            <div class="component-icon">üèÉ</div>
                            <div>Opp 2</div>
                        </div>
                        <div class="component-item green" data-type="player" data-text='C2' data-color="">
                            <div class="component-icon">üèÉ</div>
                            <div>Centro 2</div>
                        </div>
                        <div class="component-item orange" data-type="player" data-text='A' data-color="">
                            <div class="component-icon">üèÉ‚Äç‚ôÇÔ∏è</div>
                            <div>A</div>
                        </div>
                        <div class="component-item orange" data-type="player" data-text='B' data-color="">
                            <div class="component-icon">üèÉ‚Äç‚ôÇÔ∏è</div>
                            <div>B</div>
                        </div>
                        <div class="component-item orange" data-type="player" data-text='C' data-color="">
                            <div class="component-icon">üèÉ‚Äç‚ôÇÔ∏è</div>
                            <div>C</div>
                        </div>
                        <div class="component-item orange" data-type="player" data-text='D' data-color="">
                            <div class="component-icon">üèÉ‚Äç‚ôÇÔ∏è</div>
                            <div>D</div>
                        </div>
                        <div class="component-item orange" data-type="player" data-text='E' data-color="">
                            <div class="component-icon">üèÉ‚Äç‚ôÇÔ∏è</div>
                            <div>E</div>
                        </div>
                        <div class="component-item orange" data-type="player" data-text='F' data-color="">
                            <div class="component-icon">üèÉ‚Äç‚ôÇÔ∏è</div>
                            <div>F</div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="component-category">
                <h3 class="accordion-header">üèüÔ∏è Player</h3>
                <div class="accordion-content">
                    <div class="component-grid">
                        <div class="component-item" data-type="volleyball-player-bagher" data-text="">
                            <div class="component-icon">üèüÔ∏è</div>
                            <div>Bagher</div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="component-category">
                <h3 class="accordion-header">üèüÔ∏è Campi</h3>
                <div class="accordion-content">
                    <div class="component-grid">
                        <div class="component-item" data-type="court" data-text="">
                            <div class="component-icon">üèüÔ∏è</div>
                            <div>Intero</div>
                        </div>
                        <div class="component-item" data-type="half-court" data-text="">
                            <div class="component-icon">üèüÔ∏è</div>
                            <div>Met√†</div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="component-category">
                <h3 class="accordion-header">üèê Materiale</h3>
                <div class="accordion-content">
                    <div class="component-grid">
                        <div class="component-item" data-type="ball" data-text="">
                            <div class="component-icon">üèê</div>
                            <div>Pallone</div>
                        </div>
                        <div class="component-item" data-type="mat" data-text="">
                            <div class="component-icon">üü¶</div>
                            <div>Materassino</div>
                        </div>
                        <div class="component-item" data-type="net" data-text="">
                            <div class="component-icon">ü•Ö</div>
                            <div>Rete</div>
                        </div>
                        <div class="component-item" data-type="brick" data-text="">
                            <div class="component-icon">üß±</div>
                            <div>Mattone</div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="component-category">
                <h3 class="accordion-header">üîß Strumenti</h3>
                <div class="accordion-content">
                    <div class="component-grid">
                        <div class="component-item" data-type="text" data-text="Testo">
                            <div class="component-icon">üìù</div>
                            <div>Testo</div>
                        </div>
                        <div class="component-item" id="arrowModeBtn">
                            <div class="component-icon">‚û°Ô∏è</div>
                            <div>Frecce</div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="component-category">
                <h3 class="accordion-header">üé® Icone</h3>
                <div class="accordion-content">
                    <div class="component-grid">
                        <div class="component-item" data-type="icon" data-icon="fa-thin fa-volleyball" data-text="">
                            <div class="component-icon"><i class="fa-thin fa-volleyball"></i></div>
                            <div>Pallone</div>
                        </div>
                        <!-- Icone Sport -->
                        <div class="component-item" data-type="icon" data-icon="fas fa-trophy" data-text="">
                            <div class="component-icon"><i class="fas fa-trophy"></i></div>
                            <div>Trofeo</div>
                        </div>
                        <div class="component-item" data-type="icon" data-icon="fas fa-medal" data-text="">
                            <div class="component-icon"><i class="fas fa-medal"></i></div>
                            <div>Medaglia</div>
                        </div>
                        <div class="component-item" data-type="icon" data-icon="fas fa-stopwatch" data-text="">
                            <div class="component-icon"><i class="fas fa-stopwatch"></i></div>
                            <div>Timer</div>
                        </div>
                        <div class="component-item" data-type="icon" data-icon="fas fa-whistle" data-text="">
                            <div class="component-icon"><i class="fas fa-bullhorn"></i></div>
                            <div>Fischietto</div>
                        </div>
                        <!-- Frecce e Direzioni -->
                        <div class="component-item" data-type="icon" data-icon="fas fa-arrow-up" data-text="">
                            <div class="component-icon"><i class="fas fa-arrow-up"></i></div>
                            <div>Su</div>
                        </div>
                        <div class="component-item" data-type="icon" data-icon="fas fa-arrow-down" data-text="">
                            <div class="component-icon"><i class="fas fa-arrow-down"></i></div>
                            <div>Gi√π</div>
                        </div>
                        <div class="component-item" data-type="icon" data-icon="fas fa-arrow-left" data-text="">
                            <div class="component-icon"><i class="fas fa-arrow-left"></i></div>
                            <div>Sinistra</div>
                        </div>
                        <div class="component-item" data-type="icon" data-icon="fas fa-arrow-right" data-text="">
                            <div class="component-icon"><i class="fas fa-arrow-right"></i></div>
                            <div>Destra</div>
                        </div>
                        <!-- Simboli -->
                        <div class="component-item" data-type="icon" data-icon="fas fa-star" data-text="">
                            <div class="component-icon"><i class="fas fa-star"></i></div>
                            <div>Stella</div>
                        </div>
                        <div class="component-item" data-type="icon" data-icon="fas fa-heart" data-text="">
                            <div class="component-icon"><i class="fas fa-heart"></i></div>
                            <div>Cuore</div>
                        </div>
                        <div class="component-item" data-type="icon" data-icon="fas fa-check" data-text="">
                            <div class="component-icon"><i class="fas fa-check"></i></div>
                            <div>Check</div>
                        </div>
                        <div class="component-item" data-type="icon" data-icon="fa-solid fa-cart-shopping" data-text="">
                            <div class="component-icon"><i class="fa-solid fa-cart-shopping"></i></div>
                            <div>Cart</div>
                        </div>
                        <div class="component-item" data-type="icon" data-icon="fa-solid fa-hands-holding" data-text="">
                            <div class="component-icon"><i class="fa-solid fa-hands-holding"></i></div>
                            <div>palleggio</div>
                        </div>
                        <div class="component-item" data-type="icon" data-icon="fas fa-times" data-text="">
                            <div class="component-icon"><i class="fas fa-times"></i></div>
                            <div>X</div>
                        </div>
                        <div class="component-item" data-type="icon" data-icon="fa-solid fa-caret-up" data-text="">
                            <div class="component-icon"><i class="fa-solid fa-caret-up"></i></div>
                            <div>Cono</div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="component-category">
                <h3 class="accordion-header">üñºÔ∏è Immagini SVG Locali</h3>
                <div class="accordion-content">
                    <div class="component-grid">
                        <div class="component-item" data-type="local-svg" data-src="data/images/volleyball_ball.svg">
                            <div class="component-icon">
                                <img src="data/images/volleyball_ball.svg" alt="Palla Sport"
                                    style="width: 20px; height: 20px;" />
                            </div>
                            <div>Palla Sport</div>
                        </div>

                        <div class="component-item" data-type="local-svg" data-src="data/images/player-bagher.png">
                            <div class="component-icon">
                                <img src="data/images/player-bagher.png" alt="Campo volleyball"
                                    style="width: 20px; height: 20px;" />
                            </div>
                            <div>Player bagher</div>
                        </div>
                        <div class="component-item" data-type="local-svg"
                            data-src="data/images/player-bagher-front.png">
                            <div class="component-icon">
                                <img src="data/images/player-bagher-front.png" alt="Campo volleyball"
                                    style="width: 20px; height: 20px;" />
                            </div>
                            <div>Player front</div>
                        </div>
                        <div class="component-item" data-type="local-svg" data-src="data/images/player-jump-spike.png">
                            <div class="component-icon">
                                <img src="data/images/player-jump-spike.png" alt="Campo volleyball"
                                    style="width: 20px; height: 20px;" />
                            </div>
                            <div>Player spike</div>
                        </div>
                        <div class="component-item" data-type="local-svg" data-src="data/images/player-upball.png">
                            <div class="component-icon">
                                <img src="data/images/player-upball.png" alt="Campo volleyball"
                                    style="width: 20px; height: 20px;" />
                            </div>
                            <div>Player up ball</div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="component-category">
                <h3 class="accordion-header">üé¨ Sprite Pallavolo</h3>
                <div class="accordion-content">
                    <div class="component-grid">
                        <!-- Esempio: Giocatore che schiaccia -->
                        <div class="component-item" data-type="sprite"
                            data-sprite-sheet="data/images/sprites/volleyball-actions.png" data-sprite-cols="4"
                            data-sprite-rows="2" data-sprite-frame="0" data-sprite-width="64" data-sprite-height="64">

                            <div class="component-icon">
                                <div class="sprite-preview" style="
                background-image: url('data/images/sprites/volleyball-actions.png');
                background-position: 0px 0px;
                background-size: 256px 128px;
                width: 64px;
                height: 64px;
            ">
                                </div>
                            </div>

                            <div>Schiacciata</div>
                        </div>

                        <!-- Esempio: Giocatore in bagher -->
                        <div class="component-item" data-type="sprite"
                            data-sprite-sheet="data/images/sprites/volleyball-actions.png" data-sprite-cols="4"
                            data-sprite-rows="2" data-sprite-frame="1" data-sprite-width="64" data-sprite-height="64">
                            <div class="component-icon">
                                <div class="sprite-preview" style="background: url('data/images/sprites/volleyball-actions.png'); 
                                background-position: -64px 0; 
                                background-size: 256px 128px; 
                                width: 32px; 
                                height: 32px;"></div>
                            </div>
                            <div>Bagher</div>
                        </div>

                        <!-- Aggiungi altri frame qui -->
                    </div>
                </div>
            </div>
        </div>
        <div class="sidebar-handle" id="sidebarHandle">
            <button class="sidebar-switch" id="sidebarSwitch">‚óÄ</button>
        </div>

        <div class="main-content">
            <div class="toolbar">
                <fieldset class="toolbar-group">
                    <legend>Dimensione</legend>
                    <label>Dimensione:</label>
                    <select id="canvasSizeSelect">
                        <option value="custom">Personalizzato</option>
                        <option value="a5-portrait">A5 Verticale</option>
                        <option value="a5-landscape">A5 Orizzontale</option>
                        <option value="a4-portrait">A4 Verticale</option>
                        <option value="a4-landscape">A4 Orizzontale</option>
                        <option value="a3-portrait">A3 Verticale</option>
                        <option value="a3-landscape">A3 Orizzontale</option>
                        <option value="a2-portrait">A2 Verticale</option>
                        <option value="a2-landscape">A2 Orizzontale</option>
                        <option value="business-card">Biglietto da Visita</option>
                    </select>
                    <button id="toggleCanvasBorder">üñºÔ∏è Bordi</button>

                    <label>Background:</label>
                    <select id="backgroundSelect">
                        <option value="none">Nessuno</option>
                        <option value="half-field">Met√†</option>
                        <option value="full-field">Intero</option>
                        <option value="3d-field">Campo 3D</option>
                    </select>
                    <button id="zoomOut">‚ûñ</button>
                    <div class="zoom-display" id="zoomDisplay">100%</div>
                    <button id="zoomIn">‚ûï</button>
                    <button id="menu-notepad">Apri Blocco Note</button>

                </fieldset>
                <fieldset class="toolbar-group">
                    <legend>Squadra</legend>
                    <button id="manageTeamBtn">üë• Gestisci Squadra</button>
                    <button id="togglePlayerNames">üè∑Ô∏è Nomi Giocatori</button>
                </fieldset>
                <fieldset class="toolbar-group">
                    <legend>Ordina</legend>
                    <button id="bringToFront">‚¨ÜÔ∏è In primo piano</button>
                    <button id="sendToBack">‚¨áÔ∏è In background</button>
                </fieldset>
                <fieldset class="toolbar-group">
                    <legend>Visualizza</legend>
                    <button id="gridToggle">üìê Griglia</button>
                    <button id="snapToGridBtn">üß≤ Allinea alla Griglia</button>
                    <button id="bwToggle">‚ö´ B/N</button>
                    <button id="dashedToggle">‚ö° Tratteggio</button>
                    <button id="toggleLabels">üî¢ Etichette</button>
                    <button id="renumberObjects">üîÑ Rinumera</button>
                    <button id="exportPdfBtn" title="Esporta l'allenamento completo in un PDF strutturato.">üìÑ Esporta
                        PDF</button>
                    <button id="freehandModeBtn" title="Attiva modalit√† disegno a mano libera.">‚úèÔ∏è
                        Disegno</button>
                    <button id="exportFormationsBtn" title="Genera foglio formazioni per partite con 5 set">üìã Foglio
                        Formazioni</button>
                </fieldset>
                <fieldset class="toolbar-group">
                    <legend>Modifica</legend>
                    <button id="rotateLeft">‚Ü∫</button>
                    <button id="rotateRight">‚Üª</button>
                    <button id="groupRotateLeft">‚ü≤ Ruota Gruppo -15¬∞</button>
                    <button id="groupRotateRight">‚ü≥ Ruota Gruppo +15¬∞</button>
                    <button id="undoBtn">‚è™ Undo</button>
                    <button id="redoBtn">‚è© Redo</button>
                    <button id="historyBtn" title="Storico modifiche (Ctrl+H)">üìú Storico</button>
                </fieldset>

                <fieldset class="toolbar-group">
                    <legend>File</legend>
                    <input type="text" id="schemaTitle" placeholder="Titolo schema">
                    <button id="saveBtn">üíæ Salva</button>
                    <button id="saveWorkOutBtn">üíæ Salva Allenamento</button>
                    <button id="loadBtn">üìÅ Carica</button>
                    <button id="loadWorkOutBtn">üìÅ Carica Allenamento</button>
                    <input type="file" id="fileInput" accept=".json" style="display: none;">
                    <input type="file" id="workoutFileInput" accept=".json" style="display: none;">
                    <button id="exportBtn">üì§ Esporta</button>
                    <button id="exportWorkOutBtn">üì§ Genera la scheda di allenamento</button>
                    <button id="loadFromLibrary">üìÅ Libreria</button>
                </fieldset>
                <fieldset class="toolbar-group">
                    <legend>Utente</legend>
                    <div class="user-info" id="userInfo" style="display: none;">
                        <span>üë§ <span id="currentUsername"></span></span>
                        <button class="logout-button" id="logoutButton">Esci</button>
                    </div>
                </fieldset>
            </div>

            <div class="tabs-container">
                <div class="tab active" data-tab-id="1">
                    <input class='no-style tab-title' value='Schema 1' />
                    <span class="tab-close">√ó</span>
                </div>
                <button class="add-tab">+ Nuovo</button>
            </div>

            <div class="canvas-container">
                <div class="canvas" id="canvas"></div>
                <svg style="position: absolute; width: 0; height: 0;">
                    <defs>
                        <marker id="arrowhead" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
                            <polygon points="0 0, 10 3.5, 0 7" />
                        </marker>
                    </defs>
                </svg>
            </div>

            <!-- Bottom Sidebar (Object Controls) -->
            <div class="bottom-sidebar-handle" id="bottomSidebarHandle">
                <button class="bottom-sidebar-switch" id="bottomSidebarSwitch">‚ñº</button>
            </div>

            <div class="bottom-sidebar" id="bottomSidebar">
                <div class="bottom-toolbar-group">
                    <fieldset id="objectControls" class="toolbar-group fixed form-grid" style="display: none">
                        <legend>Oggetto</legend>

                        <label>Colore oggetto:</label>
                        <input type="color" class="color-picker" id="objectColor" value="#3498db">

                        <label>Opacit√†:</label>
                        <input type="range" id="objectOpacity" min="0" max="1" value="1" step="0.01">

                        <label>Valore opacit√†:</label>
                        <input type="number" id="objectOpacityValue" class="small-input" min="0" max="1" step="0.01"
                            value="1.00">

                        <label>Testo:</label>
                        <input type="text" id="objectText" placeholder="Modifica testo">

                        <label>Numero etichetta:</label>
                        <input type="number" id="objectNumber" min="1" placeholder="Numero" class="small-input">

                        <button id="dashedObjectToggle" class="toolbar-button">Tratteggiato</button>
                    </fieldset>

                    <fieldset id="arrowControls" class="toolbar-group" style="display: none">
                        <legend>Freccia</legend>
                        <div class="color-picker-container">
                            <label>Colore freccia:</label>
                            <input type="color" class="color-picker" id="arrowColor" value="#000000">
                        </div>
                        <div>
                            <label>Opacit√†:</label>
                            <input type="range" id="arrowOpacity" min="0" max="1" value="1" step="0.01">
                            <span id="arrowOpacityValue">1.00</span>
                        </div>
                        <div>
                            <label>Spessore:</label>
                            <input type="range" id="arrowThickness" min="1" max="10" value="3">
                            <span id="thicknessValue">3</span>
                        </div>
                        <div class="arrow-type-controls">
                            <label>Tipo:</label>
                            <button id="arrowTypeLinear" class="arrow-type-btn">Lineare</button>
                            <button id="arrowTypeCurved" class="arrow-type-btn">Curva</button>
                            <button id="arrowTypeZigzag" class="arrow-type-btn">Zigzag</button>
                        </div>
                        <button id="dashedArrowToggle" class="toolbar-button">Freccia Tratteggiata</button>
                    </fieldset>

                    <fieldset id="spriteControls" class="toolbar-group" style="display: none">
                        <legend>Sprite</legend>
                        <div>
                            <label>Frame corrente:</label>
                            <input type="number" id="spriteCurrentFrame" min="0" max="7" value="0" style="width: 60px;">
                            <span id="spriteFrameInfo">(0-7)</span>
                        </div>

                        <div class="sprite-animation-controls">
                            <label>Animazione:</label>
                            <input type="text" id="spriteAnimationFrames" placeholder="es: 0,1,2,3"
                                style="width: 120px;" title="Sequenza frame separati da virgola">
                            <label>FPS:</label>
                            <input type="number" id="spriteAnimationFPS" min="1" max="60" value="10"
                                style="width: 60px;">
                            <button id="spritePlayAnimation" class="toolbar-button">‚ñ∂ Play</button>
                            <button id="spriteStopAnimation" class="toolbar-button" style="display: none;">‚è∏
                                Stop</button>
                        </div>

                        <div>
                            <label>Dimensioni frame:</label>
                            <input type="number" id="spriteFrameWidth" min="8" max="512" value="64"
                                style="width: 60px;">
                            <span>√ó</span>
                            <input type="number" id="spriteFrameHeight" min="8" max="512" value="64"
                                style="width: 60px;">
                            <button id="spriteApplySize" class="toolbar-button">Applica</button>
                        </div>
                    </fieldset>

                    <fieldset class="toolbar-group">
                        <legend>Animazione</legend>
                        <button id="showAnimationControls">üé¨ Animazione</button>
                    </fieldset>
                    <fieldset id="freehandControls" class="toolbar-group" style="display: none">
                        <legend>Disegno a mano libera</legend>
                        <div class="color-picker-container">
                            <label>Colore traccia:</label>
                            <input type="color" class="color-picker" id="freehandColor" value="#000000">
                        </div>
                        <div>
                            <label>Spessore:</label>
                            <input type="range" id="freehandThickness" min="1" max="15" value="3">
                            <span id="freehandThicknessValue">3</span>
                        </div>
                        <div>
                            <label>Opacit√†:</label>
                            <input type="range" id="freehandOpacity" min="0" max="1" value="1" step="0.01">
                            <span id="freehandOpacityValue">1.00</span>
                        </div>
                    </fieldset>
                    <fieldset class="toolbar-group">
                        <legend>Frecce</legend>
                        <div class="arrow-marker-controls">
                            <input type="checkbox" id="arrowMarkerStart"><label>Inizio</label>
                            <input type="checkbox" id="arrowMarkerEnd" checked><label>Fine</label>
                        </div>
                    </fieldset>
                    <fieldset class="toolbar-group">
                        <legend>Opzioni</legend>
                        <button id="deleteBtn">üóëÔ∏è Elimina</button>
                        <span id="objectInfo">Nessun oggetto selezionato</span>
                    </fieldset>
                </div>
            </div>
        </div>
        <div class="right-sidebar-handle" id="rightSidebarHandle"><button class="right-sidebar-switch"
                id="rightSidebarSwitch">‚ñ∂</button>
        </div>
        <div class="right-sidebar" id="rightSidebar">
            <div class="exercise-steps">
                <h3>üìù Step Esercizio</h3>
                <div class="steps-controls">
                    <input type="text" id="newStepInput" placeholder="Inserisci nuovo step...">
                    <button id="addStepBtn">‚ûï Aggiungi</button>
                </div>
                <button id="generateAISteps"
                    style="width: 100%; margin: 10px 0; padding: 8px; background: #9b59b6; color: white; border: none; border-radius: 4px; cursor: pointer;">
                    ‚ú® Genera Step con AI
                </button>
                <div id="stepsList" class="steps-list">
                    <!-- Gli step verranno inseriti qui dinamicamente -->
                </div>
            </div>
            <div class="workout-details">
                <h3>üìã Dettagli Esercizio</h3>
                <div class="detail-row">
                    <div class="detail-field">
                        <label for="workoutDate">Data:</label>
                        <input type="text" id="workoutDate" placeholder="AAAA-MM-GG" pattern="\d{4}-\d{2}-\d{2}"
                            title="Inserisci la data nel formato AAAA-MM-GG (es: 2025-01-30)" required>
                    </div>
                    <div class="detail-field">
                        <label for="workoutPlace">Dove:</label>
                        <input type="text" id="workoutPlace">
                    </div>
                </div>
                <div class="detail-row">
                    <div class="detail-field">
                        <label for="workoutGroups">Gruppo:</label>
                        <select id="workoutGroups">
                            <option value="*">All</option>
                            <option value="1">1</option>
                            <option value="2">2</option>
                            <option value="3">3</option>
                            <option value="4">4</option>
                            <option value="5">5</option>
                            <option value="5">6</option>
                        </select>
                    </div>
                    <div class="detail-field">
                        <label for="workoutRuolo">Ruolo:</label>
                        <select id="workoutRuolo">
                            <option value="GEN">Generico</option>
                            <option value="L">Libero</option>
                            <option value="L1">Libero 1</option>
                            <option value="L2">Libero 2</option>
                            <option value="L+S">Libero + Schiacciatore</option>
                            <option value="L+A">Libero + Alzatore</option>
                            <option value="A">Alzatore</option>
                            <option value="S">Schiacciatore</option>
                            <option value="S1">Schiacciatore 1</option>
                            <option value="S2">Schiacciatore 2</option>
                            <option value="C">Centrale</option>
                            <option value="C1">Centrale 1</option>
                            <option value="C2">Centrale 2</option>
                            <option value="O">Opposto</option>
                        </select>
                    </div>
                </div>
                <div class="detail-row">
                    <div class="detail-field">
                        <label for="workoutNr">Ripetizioni:</label>
                        <input type="text" id="workoutNr">
                    </div>
                    <div class="detail-field">
                        <label for="workoutSeries">Serie:</label>
                        <input type="text" id="workoutSeries">
                    </div>
                </div>
                <div class="detail-row">
                    <div class="detail-field">
                        <label for="workoutTiming">Durata (sec):</label>
                        <input type="number" id="workoutTiming" min="0" max="600" value="1">
                    </div>
                    <div class="detail-field">
                        <label for="workoutRec">Recupero (sec):</label>
                        <input type="number" id="workoutRec" min="0" max="600" value="60">
                    </div>
                </div>
                <div class="detail-row">
                    <div class="detail-field">
                        <label for="workoutPeriodo">Periodo:</label>
                        <select id="workoutPeriodo">
                            <option value="GEN">Generico</option>
                            <option value="FIS">Preparazione fisica</option>
                            <option value="CAM">Campionato</option>
                            <option value="PRE">Pre-Campionato</option>
                            <option value="POS">Post-Campionato</option>
                        </select>
                    </div>



                    <div class="detail-field">
                        <label for="workoutTipologia">Tipologia:</label>
                        <select id="workoutTipologia">
                            <option value="GEN">Generico</option>
                            <option value="ANA">Analitico</option>
                            <option value="SIN">Sintetico</option>
                            <option value="GLO">Globale</option>
                        </select>
                    </div>
                </div>
                <div class="detail-row">

                    <!-- ‚úÖ NUOVI CAMPI AGGIUNTI -->
                    <div class="detail-field">
                        <label for="workoutGenere">Genere:</label>
                        <select id="workoutGenere">
                            <option value="GEN">Generico</option>
                            <option value="MIS">Misto</option>
                            <option value="M">Maschile</option>
                            <option value="F">Femminile</option>
                        </select>
                    </div>
                    <div class="detail-field">
                        <label for="workoutCategoria">Categoria:</label>
                        <select id="workoutCategoria">
                            <optgroup label="üéØ Generica">
                                <option value="GEN">Generico</option>
                            </optgroup>
                            <optgroup label="üë∂ Giovanili Maschili">
                                <option value="U12M">Under 12 M</option>
                                <option value="U13M">Under 13 M</option>
                                <option value="U14M">Under 14 M</option>
                                <option value="U15M">Under 15 M</option>
                                <option value="U16M">Under 16 M</option>
                                <option value="U17M">Under 17 M</option>
                                <option value="U18M">Under 18 M</option>
                                <option value="U19M">Under 19 M</option>
                            </optgroup>
                            <optgroup label="üëß Giovanili Femminili">
                                <option value="U12F">Under 12 F</option>
                                <option value="U13F">Under 13 F</option>
                                <option value="U14F">Under 14 F</option>
                                <option value="U16F">Under 16 F</option>
                                <option value="U18F">Under 18 F</option>
                            </optgroup>
                            <optgroup label="üèÜ Senior Maschili">
                                <option value="A1M">Superlega (A1) M</option>
                                <option value="A2M">Serie A2 M</option>
                                <option value="A3M">Serie A3 M</option>
                                <option value="BM">Serie B M</option>
                                <option value="CM">Serie C M</option>
                                <option value="DM">Serie D M</option>
                                <option value="1DM">Prima Divisione M</option>
                                <option value="2DM">Seconda Divisione M</option>
                                <option value="3DM">Terza Divisione M</option>
                            </optgroup>
                            <optgroup label="üèê Senior Femminili">
                                <option value="A1F">Serie A1 F</option>
                                <option value="A2F">Serie A2 F</option>
                                <option value="A3F">Serie A3 F</option>
                                <option value="B1F">Serie B1 F</option>
                                <option value="B2F">Serie B2 F</option>
                                <option value="CF">Serie C F</option>
                                <option value="DF">Serie D F</option>
                                <option value="1DF">Prima Divisione F</option>
                                <option value="2DF">Seconda Divisione F</option>
                                <option value="3DF">Terza Divisione F</option>
                            </optgroup>
                            <optgroup label="üåä Altri">
                                <option value="BEACH">Beach Volley</option>
                                <option value="SNOW">Snow Volley</option>
                                <option value="CSI">CSI/UISP</option>
                                <option value="SCO">Scolastico</option>
                            </optgroup>
                        </select>
                    </div>
                </div>
                <div class="detail-field">
                    <label for="workoutDescrizione">Note:</label>
                    <textarea id="workoutDescrizione" placeholder="Inserisci note sull'allenamento..."></textarea>
                </div>

                <div class="detail-field">
                    <label for="workoutAutore">Autore:</label>
                    <input type="text" id="workoutAutore" readonly
                        style="background: #95a5a6; cursor: not-allowed; border:none; width:100%;">
                </div>
            </div>
        </div>
    </div>

    <script>
        //const editor = new SchemaEditor();
        // document.addEventListener('DOMContentLoaded', () => {
        //     window.editor = new SchemaEditor();
        // });
        // Ottieni la data e ora correnti
        const now = new Date();

        // Formatta la data e ora come vuoi, ad esempio: "2025-09-24 15:30"
        const formattedDate = now.getFullYear() +
            String(now.getMonth() + 1).padStart(2, '0') +
            String(now.getDate()).padStart(2, '0') + "_ " +
            String(now.getHours()).padStart(2, '0') +
            String(now.getMinutes()).padStart(2, '0');




        // Imposta il value dinamicamente
        document.getElementById("schemaTitle").value = "Nuovo Allenamento " + formattedDate;
    </script>
    <div id="libraryDialog" class="modal">
        <div class="modal-content">
            <span class="close-button" id="closeLibraryDialog">&times;</span>
            <h2>Carica Allenamento da Libreria</h2>

            <div class="filters">
                <label for="filterPeriodo">Periodo:</label>
                <select id="filterPeriodo"></select>

                <label for="filterTipologia">Tipologia:</label>
                <select id="filterTipologia"></select>

                <label for="filterRuolo">Ruolo:</label>
                <select id="filterRuolo"></select>
            </div>

            <div class="workout-list-container">
                <ul id="workoutList">
                </ul>
            </div>
            <button id="loadSelectedWorkout" disabled>Carica Allenamento</button>
        </div>
    </div>


    <!-- Popup per nome allenamento -->
    <div id="saveWorkoutModal" class="modal">
        <div class="modal-content" style="max-width: 600px;">
            <span class="close-button" id="closeSaveWorkout">&times;</span>
            <h2>Salva Allenamento Completo</h2>

            <div id="workOutListName"></div>

            <div style="padding: 20px 0;">
                <label for="workoutFileName" style="display: block; margin-bottom: 10px; font-weight: bold;">
                    Nome del file:
                </label>
                <input type="text" id="workoutFileName"
                    style="width: 100%; padding: 8px; border: 1px solid #bdc3c7; border-radius: 4px; margin-bottom: 15px;"
                    placeholder="es: Allenamento_Settimana1">

                <label for="workoutGlobalObjective" style="display: block; margin-bottom: 10px; font-weight: bold;">
                    Obiettivo dell'allenamento:
                </label>
                <textarea id="workoutGlobalObjective"
                    style="width: 100%; padding: 8px; border: 1px solid #bdc3c7; border-radius: 4px; margin-bottom: 15px; resize: vertical; min-height: 80px; font-family: inherit;"
                    placeholder="Descrivi l'obiettivo generale di questo allenamento..."></textarea>

                <label for="workoutGlobalObservations" style="display: block; margin-bottom: 10px; font-weight: bold;">
                    Osservazioni:
                </label>
                <textarea id="workoutGlobalObservations"
                    style="width: 100%; padding: 8px; border: 1px solid #bdc3c7; border-radius: 4px; resize: vertical; min-height: 100px; font-family: inherit;"
                    placeholder="Aggiungi eventuali osservazioni o note post-allenamento..."></textarea>
            </div>

            <div style="display: flex; gap: 10px; justify-content: flex-end;">
                <button id="cancelSaveWorkout"
                    style="padding: 8px 16px; background: #95a5a6; color: white; border: none; border-radius: 4px; cursor: pointer;">
                    Annulla
                </button>
                <button id="confirmSaveWorkout"
                    style="padding: 8px 16px; background: #27ae60; color: white; border: none; border-radius: 4px; cursor: pointer;">
                    Salva
                </button>
            </div>
        </div>
    </div>


    <!-- Login Modal - VolleyProW4 Edition -->
    <div id="loginModal" class="login-modal">
        <div class="volley-bg"></div>
        <div class="volley-ball"></div>

        <div class="login-content">
            <h2 class="login-title">Benvenuto in <span class="highlight">VolleyPro<span class="w4">W4</span></span>
            </h2>
            <h3 class="login-subtitle">Editor Professionale per Allenatori di Pallavolo</h3>

            <form id="loginForm">
                <div class="login-field">
                    <label for="username">Username</label>
                    <input type="text" id="username" name="username" required placeholder="Inserisci username"
                        value="admin">
                </div>
                <div class="login-field">
                    <label for="password">Password</label>
                    <input type="password" id="password" name="password" required placeholder="Inserisci password"
                        value="1234">
                </div>
                <div class="login-error" id="loginError">Username o password errati</div>
                <button type="submit" class="login-button">Accedi</button>
            </form>
        </div>
    </div>




    <!-- Aggiungi questa dialog FUORI da object-controls, prima della chiusura di </body> -->
    <div id="animationDialog">
        <div class="animation-dialog-header" id="animationDialogHeader">
            <h3>üé¨ Controlli Animazione</h3>
            <button class="animation-dialog-close" id="closeAnimationDialog">&times;</button>
        </div>
        <div class="animation-dialog-body">
            <!-- Controlli Riproduzione -->
            <div class="animation-control-section">
                <h4>‚ñ∂Ô∏è Riproduzione</h4>
                <div class="animation-controls-row">
                    <button id="animationPlay" title="Play">‚ñ∂Ô∏è</button>
                    <button id="animationPause" title="Pause" style="display: none;">‚è∏Ô∏è</button>
                    <button id="animationStop" title="Stop">‚èπÔ∏è</button>
                    <button id="animationPrevFrame" title="Frame Precedente">‚èÆÔ∏è</button>
                    <button id="animationNextFrame" title="Frame Successivo">‚è≠Ô∏è</button>
                    <span class="frame-display" id="currentFrameDisplay">Frame: 0</span>
                </div>
            </div>

            <!-- Velocit√† -->
            <div class="animation-control-section">
                <h4>‚ö° Velocit√†</h4>
                <div class="animation-controls-row">
                    <label>ms/frame:</label>
                    <input type="number" id="animationSpeed" min="100" max="5000" value="1000" step="100">
                </div>
            </div>

            <!-- Gestione Frame -->
            <div class="animation-control-section">
                <h4>üìã Frame Timeline</h4>
                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 8px;">
                    <button id="addFrameBtn" style="background: #27ae60; color: white; border: none;">‚ûï Nuovo
                        Frame</button>
                </div>
                <div id="framesList">
                    <!-- Popolato dinamicamente -->
                </div>
            </div>

            <!-- Propriet√† Frame Selezionato -->
            <div id="frameProperties" style="display: none;">
                <h5>üé® Propriet√† Frame <span id="frameNumber"></span></h5>
                <div style="margin-bottom: 10px;">
                    <label style="font-weight: bold;">‚è±Ô∏è Timestamp (ms): <input type="number" id="frameTimestamp"
                            min="0" step="100" style="width: 100px;"></label>
                    <span style="font-size: 10px; color: #7f8c8d; margin-left: 10px;">(tempo in millisecondi nella
                        timeline)</span>
                </div>
                <div class="frame-properties-grid">
                    <label>X: <input type="number" id="frameX" step="1"></label>
                    <label>Y: <input type="number" id="frameY" step="1"></label>
                    <label>Larghezza: <input type="number" id="frameWidth" step="1"></label>
                    <label>Altezza: <input type="number" id="frameHeight" step="1"></label>
                    <label>Rotazione: <input type="number" id="frameRotation" step="15"></label>
                    <label>Opacit√†: <input type="number" id="frameOpacity" min="0" max="1" step="0.1"></label>
                    <label>Colore: <input type="color" id="frameColor"></label>
                    <label style="flex-direction: row; align-items: center;">
                        <input type="checkbox" id="frameDashed"> Tratteggiato
                    </label>
                </div>
                <div class="frame-actions">
                    <button id="updateFrameBtn">üíæ Aggiorna</button>
                    <button id="deleteFrameBtn">üóëÔ∏è Elimina</button>
                </div>
            </div>
        </div>
    </div>


    <div id="historyDialog" class="windows-dialog">
        <div class="windows-dialog-header" id="historyDialogHeader">
            <h3>üìú Storico Modifiche</h3>
            <button class="windows-dialog-close" id="closeHistoryDialog">&times;</button>
        </div>
        <div class="windows-dialog-body">
            <div class="history-list-panel">
                <div id="historyList">
                    <!-- Popolato dinamicamente -->
                </div>
            </div>
            <div class="history-preview-panel">
                <div class="history-preview-header">
                    <strong id="historyPreviewTitle">Seleziona una modifica per visualizzare l'anteprima</strong>
                </div>
                <div class="history-preview-content">
                    <div class="history-preview-canvas" id="historyPreviewCanvas">
                        <!-- Canvas di preview -->
                    </div>
                    <div class="history-preview-stats" id="historyPreviewStats">
                        <!-- Statistiche della modifica -->
                    </div>
                </div>
                <div class="history-actions">
                    <button class="btn-delete-history" id="deleteHistoryBtn" disabled>üóëÔ∏è Elimina</button>
                    <button class="btn-compare" id="compareHistoryBtn" disabled>üîÑ Confronta</button>
                    <button class="btn-restore" id="restoreHistoryBtn" disabled>‚úÖ Ripristina</button>
                </div>
            </div>
        </div>
    </div>


    <team-management-dialog></team-management-dialog>
    <water-mark></water-mark>
    <script defer src="components/schemaeditor.js"></script>
    <script defer src="components/helper.js"></script>
    <script defer src="components/components.js"></script>
    <script defer src="components/menuitem.js"></script>

    <script>
        /* =========================
           Menu buttons - example windows
           ========================= */
        document.getElementById('menu-notepad').addEventListener('click', () => {
            createWindow({
                title: 'Blocco Note',
                contentHTML: `<textarea style="width:100%;height:100%;box-sizing:border-box">Qui puoi scrivere...</textarea>`,
                buttons: [
                    { label: 'Conferma', onClick: () => alert('Confermato') },
                    { label: 'Annulla', onClick: () => alert('Annullato') }
                ]
            });
        });

        document.addEventListener("DOMContentLoaded", () => {
            buildMenu(menuData);
            setDefaultDate('workoutDate');
            window.editor = new SchemaEditor();
            // Associa la funzione al pulsante 'Esporta PDF'
            const exportBtn = document.getElementById('exportPdfBtn');
            if (exportBtn) {
                exportBtn.addEventListener('click', () => {
                    if (window.editor && window.editor.exportWorkoutToPDF) {
                        window.editor.exportWorkoutToPDF();
                    } else {
                        alert('Errore: La funzione di esportazione non √® stata caricata correttamente.');
                    }
                });
            }
        });
    </script>
</body>

</html>